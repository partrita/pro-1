# GRPO를 이용한 유전자 온톨로지 용어 예측

이 모듈은 단백질의 아미노산 서열을 기반으로 유전자 온톨로지(GO) 용어를 예측하기 위한 일반화된 보상-벌점 최적화(GRPO)를 구현합니다. 모델은 학습 데이터셋의 실제 주석과 일치하는 GO 용어 예측을 생성하도록 학습됩니다.

## 개요

유전자 온톨로지(GO)는 다양한 추상화 수준에서 유전자 및 유전자 산물의 생물학적 기능을 설명하는 개념 계층입니다. 세 가지 하위 온톨로지로 구성됩니다.

1. **분자 기능(MFO)**: 단백질이 분자 수준에서 수행하는 작업
2. **생물학적 과정(BPO)**: 단백질이 참여하는 생물학적 과정
3. **세포 구성 요소(CCO)**: 단백질이 세포 내에 위치하는 장소

이 구현은 서열을 기반으로 단백질의 분자 기능(MFO) 용어를 예측하는 데 중점을 둡니다.

## 필수 파일

학습을 실행하려면 다음 파일이 필요합니다.

- `train_sequences.fasta`: FASTA 형식의 단백질 서열
- `train_terms.tsv`: 단백질에 대한 GO 용어 주석 (UniProt ID, GO 용어 ID, 측면)
- `go-basic.obo`: GO 온톨로지 구조

제공된 스크립트를 사용하여 이러한 파일을 다운로드할 수 있습니다.

```bash
bash scripts/download_go_data.sh
```

## 학습 실행

1. 필수 종속성 설치:

```bash
pip install -r requirements.txt
```

2. 학습 스크립트 실행:

```bash
cd function
python functional_grpo.py
```

## 모델 학습

학습 과정:

1. 단백질 서열, GO 용어 주석 및 GO 구조 로드
2. 각 단백질에 대한 프롬프트 구성
3. GRPO를 사용하여 GO 용어를 예측하는 모델 학습
4. 실제 GO 용어와 일치하는 예측에 보상

## 보상 함수

보상 함수는 다음을 사용합니다.

- 예측된 GO 용어와 실제 용어를 비교하는 정밀도, 재현율 및 F1 점수
- \boxed{} 표기법을 사용하여 올바르게 형식이 지정된 출력에 대한 보상
- 충분한 사고 길이에 대한 작은 보상

## 모델 출력 형식

모델은 다음 형식으로 출력을 생성합니다.

```
<think>
[서열 분석을 기반으로 한 단백질 기능에 대한 자세한 추론]
</think>
<answer>
분석 결과 이 단백질은 다음과 같은 GO 용어를 가질 가능성이 높습니다.
- GO:0003674 (molecular_function): [추론]
- GO:0005515 (protein binding): [추론]
- GO:0046872 (metal ion binding): [추론]

\boxed{GO:0003674,GO:0005515,GO:0046872}
</answer>
```

보상 함수는 \boxed{} 표기법에서 GO 용어를 추출하여 실제 용어와 비교합니다.

## 구성

스크립트에서 다음 매개변수를 조정할 수 있습니다.

- `MAX_EXAMPLES`: 처리할 최대 예제 수
- `NUM_EPOCHS`: 학습 에포크 수
- `GO_PREDICTION_REWARD`: 정확한 예측에 대한 보상 승수
- `FORMATTED_OUTPUT_REWARD`: 올바르게 형식이 지정된 출력에 대한 보상
- `MAX_INPUT_LENGTH` 및 `MAX_OUTPUT_LENGTH`: 모델 서열 길이 제한
